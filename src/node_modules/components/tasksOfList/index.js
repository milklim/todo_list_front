import React, {Component} from 'react'
import {connect} from 'react-redux'
import {
    filter,
    equals
} from 'ramda'

import {
    fetchListTasks
} from 'actions'

import {
    getAllTasks,
    getTasksOfList
} from "selectors";


class TasksOfList extends Component {
    componentDidMount () {
        this.props.fetchListTasks(this.props.listId) //param
    }

    renderTask(task){
        return(
            <div className="panel-body" key={task.id}>
                {task.content}
            </div>
        )
    }

    render() {
        const {tasks} = this.props
        const isInList = (task) => equals(task.list_id, this.props.listId)
        const currTasks = filter(isInList, tasks)
        // console.log('ListId => ', this.props.listId)
        // console.log('currTasks => ', currTasks)

        return (
            <div>
                {currTasks.map((task) => this.renderTask(task))}
            </div>
        )
    }
}


const mapStateToProps = (state) => {
   // console.log('TasksOfList.mapStateToProps', this.props.listId)

    return {
        tasks: getAllTasks(state)
    }
}

const mapDispatchToProps = {
    fetchListTasks
}

export default connect(mapStateToProps, mapDispatchToProps)(TasksOfList)